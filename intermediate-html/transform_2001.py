# Copyright (c) 2025 - Present. IKWF History. All rights reserved.

import pathlib

import bracket_utils

HERE = pathlib.Path(__file__).resolve().parent
TOURNAMENT_ID = 32
TEAM_SCORE_ID_START = 1
TEAM_ACRONYM_MAPPING: dict[str, str] = {
    "ABC": "ALEDO BEAR COUNTRY W",
    "ACE": "ACES WRESTLING",
    "AOK": "A-O KIDS WC",
    "BAD": "BADGER WC",
    "BAT": "BATAVIA PINNERS",
    "BB": "BELVIDERE BANDITS",
    "BH": "BISMARK-HENNING WC",
    "BJH": "BETHALTO JR HIGH",
    "BJW": "BENTON JR. WC",
    "BLD": "BELLEVILLE LITTLE DE",
    "CHE": "CHENOA MAT CATS",
    "CHL": "CHILLICOTHE WC",
    "CJT": "CARY JR TROJAN MATME",
    "CYW": "CUMBERLAND YOUTH WC",
    "DAK": "DAKOTA WC",
    "DH": "DUNDEE HIGHLANDERS",
    "DIX": "DIXON WC",
    "DPC": "DURAND-PECATONICA",
    "EMP": "EAST MOLINE PANTHER",
    "EWC": "EDWARDSVILLE WC",
    "FPR": "FRANKLIN PARK RAIDER",
    "FVW": "FOX VALLEY WC",
    "FYW": "FALCON YOUTH WC",
    "GED": "GLEN ELLYN DUNGEON W",
    "HAW": "HOOPESTON AREA WC",
    "HBJ": "HIGHLAND BULLDOG JR",
    "HC": "HARLEM COUGARS",
    "HJT": "HILLSBORO JR TOPPERS",
    "HON": "HONONEGAH KIDS WC",
    "HUS": "HUSKIES WC",
    "JAC": "JACKSONVILLE WC",
    "JFW": "JACOBS FALCONS",
    "JGE": "JR GOLDEN EAGLES",
    "JRW": "JR ROCKET WRESTLING",
    "LB": "LEMONT BEARS WC",
    "LC": "LITTLE CELTIC WC",
    "LCW": "LAWRENCE COUNTY WC",
    "LIT": "LITTLE BOILER WC",
    "LLP": "LAKELAND PREDATORS",
    "LPC": "L-P CRUNCHING CAVS",
    "MAR": "MARENGO WC",
    "MAT": "MATTOON YOUTH WC",
    "ME": "MAINE EAGLES WC",
    "MET": "METAMORA KIDS WC",
    "MFV": "MARTINEZ FOX VALLEY",
    "MOR": "MORTON YOUTH WRESTLI",
    "MTV": "MT VERNON LIONS",
    "MTZ": "MT ZION WC",
    "MUR": "MURPHYSBORO WRESTLIN",
    "OAK": "OAKWOOD WC",
    "OC": "OSWEGO COUGARS",
    "OPP": "ORLAND PARK PIONEERS",
    "OSP": "OSWEGO PANTHERS",
    "PCW": "PANTHER CUB WC",
    "PLW": "PLAINFIELD WOLVES WC",
    "PPW": "PONTIAC PYTHONS",
    "PWC": "PLAINFIELD WC",
    "RAM": "RAMS WC",
    "RFR": "ROCK FALLS RIPPIN",
    "RIV": "RIVERBEND WC",
    "ROX": "ROXANA KIDS WC",
    "RWC": "ROCKFORD WC",
    "SC": "SPRINGFIELD CAPTIALS",
    "SHE": "SHERRAND JR WC",
    "SN": "STERLING NEWMAN JR",
    "SSW": "SOUTHSIDE WC",
    "SVW": "STILLMAN VALLEY WC",
    "SW": "STATELINE WILDCATS",
    "SYW": "SAUKEE YOUTH WC",
    "TAY": "TAYLORVILLE WC",
    "TPB": "TINLEY PARK BULLDOGS",
    "TTT": "TIGERTOWN TANGLERS",
    "TWC": "TIGER WC",
    "VAN": "VANDALIA JR WRESTLIN",
    "VC": "VITTUM CATS",
    "VLC": "VILLA LOMBARD COUGAR",
    "WES": "WESTVILLE YOUTH WC",
    "WF": "WEST FRANKFORT JR WC",
    "WFL": "WRESTLING FACTORY",
    "WME": "WHEATON MONROE EAGLE",
    "WWC": "WOLFPAK WC",
    "YWC": "YORKVILLE WC",
}
# NOTE: Sometimes acronyms (or team names) differ between Novice and Senior
#       in the Team Scores.
NOVICE_TEAM_ACRONYM_MAPPING: dict[str, str] = {
    "AC": "ARLINGTON CARDINALS",
    "BRO": "BRONCO WRESTLING",
    "BWC": "BRAWLERS WC",
    "CCK": "CHAMPAIGN CHARGER KD",
    "CKW": "CARLINVILLE KIDS WC",
    "CLW": "CRYSTAL LAKE WIRZARD",
    "CPC": "CAMP POINT CENTRAL",
    "CWC": "CARBONDALE WC",
    "EUR": "EUREKA KIDS WC",
    "FIS": "FISHER WC",
    "GDW": "GRAPPLIN'DEVILS WC",
    "GEJ": "GLENBARD EST JR RAMS",
    "GEN": "GENERALS",
    "HRD": "HINSDALE RED DEVIL W",
    "IB": "ILLINI BLUFFS WC",
    "JRM": "JR MAROON WC",
    "JRS": "JR SENTINELS",
    "LIN": "LITTLE INDIANS",
    "MCY": "MIDWEST CENTRAL YOUT",
    "MEN": "MENDOTA MAT MASTERS",
    "MKW": "MACOMB KIDS WRESTLIN",
    "MS": "METRO STALLIONS",
    "NW": "NAPERVILLE WARHAWKS",
    "OLW": "OAK LAWN PD WILDCATS",
    "PLH": "PLANIFIELD HUSKIES W",
    "POL": "POLO WC",
    "PON": "PONY EXPRESS WC",
    "SAV": "SAVANNA REDHAWKS",
    "SIE": "SOUTHERN IL EAGLES",
    "SJO": "SHO YOUTH WRESTLING",
    "UNI": "UNITY WRESTLING CLUB",
    "WAR": "WARRENSBURG WC",
    "WAU": "WAUBONSIE TRAILBLAZE",
    "WCI": "WEST CHICAGO PD",
    "YOU": "YOUNG CHAMPIONS",
}
SENIOR_TEAM_ACRONYM_MAPPING: dict[str, str] = {
    "ADA": "ADDISON ANIMALS",  # Duplicate (team name shows up twice in Senior Team Scores)
    "BGP": "BOYS & GIRLS CLUB",  # ... of Pekin
    "BRL": "BRAWLERS WC",
    "BWC": "BRAWLERS WC (2)",
    "CCK": "CHAMPAIGN CHARGER KI",
    "CEN": "CENTRALIA WC",
    "CHA": "CHARLESTON WC",
    "CHR": "CHARLESTON WC (2)",
    "CLW": "CRYSTAL LAKE WIZARDS",
    "DC": "DUNDEE CARPETERVILL",
    "DEC": "DECATUR WC",
    "EMS": "ERIE MIDDLE SCHOOL W",  # Duplicate (team name shows up twice in Senior Team Scores)
    "EP": "EDISON PANTHERS",
    "FVC": "FOX VALLEY CRONE WC",
    "FWC": "FISHER WC",
    "GDW": "GRAPPLIN DEVILS WC",
    "GEJ": "GLENBARD EAST JR RAM",
    "GJS": "GALESBURG JR STRK 2",
    "GWC": "GENESEO WC",
    "HRD": "HINSDALE RED DEVILS",
    "JRK": "JUNIOR ROCKS WRESTLI",
    "JUN": "JUNIOR PIRATE WC",
    "LJW": "LAKE VIEW JR WILDCAT",
    "LRB": "LITTLE REDBIRD WC",
    "LSW": "LIL STORM YOUTH",
    "LVL": "LAKE VILLA LANCERS",
    "LYW": "LIMESTONE YOUTH ROCK",
    "MAN": "MANTENO JR PANTHERS",
    "NAP": "NAPERVILLE WC",
    "NE": "NAPERVILLE EAGLES",
    "NL": "NAPERVILLE LANCERS",
    "OLW": "OAK LAWN P.D. WILDCA",
    "PIN": "PINCKNEYVILLE JR",
    "PLT": "PLT PROPHETS WC",
    "RJH": "RIVERDALE JR HIGH",
    "RMD": "RICHMOND WC",
    "ROC": "ROCHELLE WC",
    "SHA": "SHARKS WC",
    "SIE": "SOUTHERN ILLINOIS EA",
    "SJO": "SJO YOUTH WRESTLING",
    "SJW": "SHELBYVILLE JUNIOR R",
    "STB": "ST BEDE WC",
    "TCB": "TRI-CITY BRAVES",
    "VPY": "VILLA PARK YOUNG",
    "WAB": "WAUBONSIE BULLDOGS",
    "WAG": "WAUONSIE GRIZZLIES",
    "WB": "WHEATON BULLDOGS",
    "WHC": "WHEATON WC",
    "WHE": "WHEATON BULLDOGS (2)",
    "WHT": "WHEATON WC (2)",
    "WJP": "WASHINGTON JR PANTHE",
}
TEAM_NAME_MAPPING: dict[str, int] = {
    "A-O KIDS WC": 8,
    "ACES WRESTLING": 3,
    "ADDISON ANIMALS (2)": 10147,  # ADD
    "ADDISON ANIMALS": 10147,
    "ALEDO BEAR COUNTRY W": 10002,
    "ARLINGTON CARDINALS": 9,
    "BADGER WC": 14,
    "BATAVIA PINNERS": 10005,
    "BELLEVILLE LITTLE DE": 23,
    "BELVIDERE BANDITS": 24,
    "BENTON JR. WC": 26,
    "BETHALTO JR HIGH": 10118,
    "BISMARCK-HENNING WC": 28,
    "BISMARK-HENNING WC": 28,
    "BOYS & GIRLS CLUB": 319,
    "BRAWLERS WC (2)": 39,
    "BRAWLERS WC": 39,
    "BRONCO WRESTLING": 41,
    "CAMP POINT CENTRAL": 50,
    "CARBONDALE WC": 53,
    "CARLINVILLE KIDS WC": 54,
    "CARY JR TROJAN MATME": 59,
    "CENTRALIA WC": 64,
    "CHAMPAIGN CHARGER KD": 10124,
    "CHAMPAIGN CHARGER KI": 10124,
    "CHARLESTON WC (2)": 69,
    "CHARLESTON WC": 69,
    "CHENOA MAT CATS": 10011,
    "CHILLICOTHE WC": 10014,
    "CROSSFACE WRESTLING": 10018,  # CW
    "CRYSTAL LAKE WIRZARD": 89,
    "CRYSTAL LAKE WIZARDS": 89,
    "CUMBERLAND YOUTH WC": 90,
    "DAKOTA WC": 92,
    "DECATUR WC": 10137,
    "DIXON WC": 98,
    "DUNDEE CARPETERVILL": 10163,
    "DUNDEE HIGHLANDERS": 102,
    "DUNDEE WESTFIELD": 10172,  # DW
    "DURAND-PECATONICA": 105,
    "EAST MOLINE PANTHER": 10121,
    "EDISON PANTHERS": 10131,
    "EDWARDSVILLE WC": 110,
    "ERIE MIDDLE SCHOOL W (2)": 10025,  # ERI
    "ERIE MIDDLE SCHOOL W": 10025,
    "EUREKA KIDS WC": 117,
    "FALCON YOUTH WC": 123,
    "FISHER WC": 130,
    "FOX VALLEY CRONE WC": 10162,
    "FOX VALLEY WC": 134,
    "FRANKLIN PARK RAIDER": 10138,
    "GALESBURG JR STREAKS": 10030,  # GAL
    "GALESBURG JR STRK 2": 10030,
    "GENERALS": 10144,
    "GENESEO WC": 10033,
    "GLEN ELLYN DUNGEON W": 10039,
    "GLENBARD EAST JR RAM": 147,
    "GLENBARD EST JR RAMS": 147,
    "GRAPPLIN DEVILS WC": 153,
    "GRAPPLIN'DEVILS WC": 153,
    "HARLEM COUGARS": 10041,
    "HERRIN WC": 10042,  # HER
    "HIGHLAND BULLDOG JR": 168,
    "HILLSBORO JR TOPPERS": 170,
    "HINSDALE RED DEVIL W": 171,
    "HINSDALE RED DEVILS": 171,
    "HONONEGAH KIDS WC": 173,
    "HOOPESTON AREA WC": 174,
    "HUSKIES WC": 10145,
    "ILLINI BLUFFS WC": 181,
    "JACKSONVILLE WC": 189,
    "JACOBS FALCONS": 10161,
    "JR GOLDEN EAGLES": 10050,
    "JR MAROON WC": 538,
    "JR ROCKET WRESTLING": 10052,
    "JR SENTINELS": 10054,
    "JUNIOR PIRATE WC": 201,
    "JUNIOR ROCKS WRESTLI": 10160,
    "L-P CRUNCHING CAVS": 241,
    "LAKE VIEW JR WILDCAT": 10159,
    "LAKE VILLA LANCERS": 10141,
    "LAKELAND PREDATORS": 10057,
    "LAWRENCE COUNTY WC": 217,
    "LEMONT BEARS WC": 219,
    "LIL STORM YOUTH": 10060,
    "LIMESTONE YOUTH ROCK": 10061,
    "LITTLE BOILER WC": 232,
    "LITTLE CELTIC WC": 233,
    "LITTLE GIANTS": 641,  # LG
    "LITTLE INDIANS": 10063,
    "LITTLE REDBIRD WC": 10065,
    "MACOMB KIDS WRESTLIN": 243,
    "MAINE EAGLES WC": 245,
    "MANTENO JR PANTHERS (2)": 247,
    "MANTENO JR PANTHERS": 247,
    "MARENGO WC": 248,
    "MARTINEZ FOX VALLEY": 250,
    "MATTOON YOUTH WC": 252,
    "MENDOTA MAT MASTERS": 10072,
    "METAMORA KIDS WC": 262,
    "METRO STALLIONS": 10142,
    "MIDWEST CENTRAL YOUT": 263,
    "MORTON YOUTH WRESTLI": 272,
    "MT VERNON LIONS": 275,
    "MT ZION WC": 276,
    "MURPHYSBORO WRESTLIN": 278,
    "NAPERVILLE EAGLES": 10133,
    "NAPERVILLE LANCERS (2)": 10157,
    "NAPERVILLE LANCERS": 10157,
    "NAPERVILLE WARHAWKS": 10158,
    "NAPERVILLE WC": 281,
    "OAK LAWN P.D. WILDCA": 10075,
    "OAK LAWN PD WILDCATS": 10075,
    "OAKWOOD WC": 299,
    "ORLAND PARK PIONEERS": 306,
    "OSWEGO COUGARS": 10136,
    "OSWEGO PANTHERS": 10076,
    "PANTHER CUB WC": 10079,
    "PINCKNEYVILLE JR": 10122,
    "PLAINFIELD WC": 326,
    "PLAINFIELD WOLVES WC": 10155,
    "PLANIFIELD HUSKIES W": 10156,
    "PLT PROPHETS WC": 10127,
    "POLO WC": 327,
    "PONTIAC PYTHONS": 10082,
    "PONY EXPRESS WC": 10154,
    "RAMS WC": 236,
    "RICHMOND WC (2)": 350,  # RIC
    "RICHMOND WC": 350,
    "RIVERBEND WC": 354,
    "RIVERDALE JR HIGH": 10153,
    "ROCHELLE WC": 358,
    "ROCK FALLS RIPPIN": 10152,
    "ROCKFORD WC": 364,
    "ROXANA KIDS WC": 371,
    "SAUKEE YOUTH WC": 376,
    "SAVANNA REDHAWKS": 10089,
    "SHARKS WC": 381,
    "SHELBYVILLE JR RAMS": 382,
    "SHELBYVILLE JUNIOR R": 382,
    "SHERRAND JR WC": 383,
    "SHERRARD JR WC": 383,
    "SHO YOUTH WRESTLING": 402,
    "SJO YOUTH WRESTLING": 402,
    "SOUTHERN IL EAGLES": 10092,
    "SOUTHERN ILLINOIS EA": 10092,
    "SOUTHSIDE WC": 10140,
    "SPRINGFIELD CAPITALS": 397,
    "SPRINGFIELD CAPTIALS": 397,
    "ST BEDE WC": 10095,
    "STATELINE WILDCATS": 10097,
    "STERLING NEWMAN JR": 10098,
    "STILLMAN VALLEY WC": 407,
    "TAYLORVILLE WC": 420,
    "TIGER WC": 10103,
    "TIGERTOWN TANGLERS": 441,
    "TINLEY PARK BULLDOGS": 443,
    "TRI-CITY BRAVES": 10104,
    "UNITY WRESTLING CLUB": 457,
    "VANDALIA JR WRESTLIN": 461,
    "VILLA LOMBARD COUGAR": 10109,
    "VILLA PARK YOUNG": 464,
    "VITTUM CATS": 466,
    "WARRENSBURG WC": 468,
    "WASHINGTON JR PANT": 10110,
    "WASHINGTON JR PANTHE": 10110,
    "WAUBONSIE BULLDOGS": 10149,
    "WAUBONSIE TRAILBLAZE": 10151,
    "WAUONSIE GRIZZLIES": 10150,
    "WEST CHICAGO PD": 10148,
    "WEST FRANKFORT JR WC": 478,
    "WESTVILLE YOUTH WC": 482,
    "WHEATON BULLDOGS (2)": 10120,
    "WHEATON BULLDOGS": 10120,
    "WHEATON MONROE EAGLE": 10114,
    "WHEATON WC (2)": 234,
    "WHEATON WC": 234,
    "WOLFPAK WC": 490,
    "WRESTLING FACTORY": 10115,
    "YORKVILLE WC": 497,
    "YOUNG CHAMPIONS": 10116,
}
NOVICE_EXTRA_TEAM_SCORES: dict[str, float] = {
    "HERRIN WC": 2.0,
    ########################################
    "BISMARCK-HENNING WC": 0.0,
    "CROSSFACE WRESTLING": 0.0,
    "GENESEO WC": 0.0,
    "JUNIOR PIRATE WC": 0.0,
    "LITTLE GIANTS": 0.0,
    "SHELBYVILLE JR RAMS": 0.0,
    "SHERRARD JR WC": 0.0,
    ########################################
    "WASHINGTON JR PANT": -1.0,
}
SENIOR_EXTRA_TEAM_SCORES: dict[str, float] = {
    "ADDISON ANIMALS (2)": 0.0,
    "DUNDEE WESTFIELD": 0.0,
    "ERIE MIDDLE SCHOOL W (2)": 0.0,
    "GALESBURG JR STREAKS": 0.0,
    "JR SENTINELS": 0.0,
    "MANTENO JR PANTHERS (2)": 0.0,
    "NAPERVILLE LANCERS (2)": 0.0,
    "RICHMOND WC (2)": 0.0,
    "SPRINGFIELD CAPITALS": 0.0,
}


def main():
    with open(HERE / "extracted.2001.json") as file_obj:
        extracted = bracket_utils.ExtractedTournament.model_validate_json(
            file_obj.read()
        )

    weight_classes = extracted.weight_classes
    bracket_utils.validate_acronym_mapping_names(
        weight_classes,
        (
            TEAM_ACRONYM_MAPPING,
            NOVICE_TEAM_ACRONYM_MAPPING,
            SENIOR_TEAM_ACRONYM_MAPPING,
        ),
        (NOVICE_EXTRA_TEAM_SCORES, SENIOR_EXTRA_TEAM_SCORES),
        TEAM_NAME_MAPPING,
    )
    unclassified = sorted(
        name for name, team_id in TEAM_NAME_MAPPING.items() if team_id < 0
    )
    if unclassified:
        raise ValueError("Some teams are unclassified", unclassified)

    bracket_utils.validate_acronym_mappings_divisons(
        weight_classes,
        TEAM_ACRONYM_MAPPING,
        NOVICE_TEAM_ACRONYM_MAPPING,
        SENIOR_TEAM_ACRONYM_MAPPING,
    )

    team_scores: list[bracket_utils.TeamScoreRow] = []
    team_scores.extend(
        bracket_utils.team_scores_for_sql(
            "novice",
            TOURNAMENT_ID,
            extracted,
            TEAM_ACRONYM_MAPPING,
            NOVICE_TEAM_ACRONYM_MAPPING,
            TEAM_NAME_MAPPING,
            NOVICE_EXTRA_TEAM_SCORES,
        )
    )
    team_scores.extend(
        bracket_utils.team_scores_for_sql(
            "senior",
            TOURNAMENT_ID,
            extracted,
            TEAM_ACRONYM_MAPPING,
            SENIOR_TEAM_ACRONYM_MAPPING,
            TEAM_NAME_MAPPING,
            SENIOR_EXTRA_TEAM_SCORES,
        )
    )

    bracket_utils.set_team_score_ids(team_scores, TEAM_SCORE_ID_START)
    bracket_utils.print_team_score_sql(team_scores)


if __name__ == "__main__":
    main()
