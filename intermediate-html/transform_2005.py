# Copyright (c) 2025 - Present. IKWF History. All rights reserved.

import pathlib

import bracket_utils

HERE = pathlib.Path(__file__).resolve().parent
TOURNAMENT_ID = 36
TEAM_SCORE_ID_START = 1333
TEAM_ACRONYM_MAPPING: dict[str, str] = {
    "AJW": "A-J JUNIOR WILDCATS",
    "ANI": "ANIMALS WC",
    "ARL": "ARLINGTON CARDNALS",
    "BAT": "BATAVIA PINNERS",
    "BDG": "BADGERS WC",
    "BKH": "BLACKHAWK WC",
    "BLD": "BELLEVILLE LITTLE DEVILS",
    "BLM": "BLOOMINGTON RAIDERS WC",
    "BRL": "BRAWLERS",
    "BRR": "BARRINGTON BRONCOS",
    "BSN": "BISON WC",
    "BTB": "BETHALTO BULLS WC",
    "CHM": "CHAMPAIGN KIDS WC",
    "CJS": "CARBONDALE JUNIOR SPIRITS",
    "CLW": "CRYSTAL LAKE WIZARDS",
    "CMB": "CUMBERLAND YOUTH WC",
    "CTC": "CROSSTOWN CRUSHERS",
    "CVR": "COLLINSVILLE RAIDERS",
    "DAK": "DAKOTA WC",
    "DDH": "DUNDEE HIGHLANDERS",
    "DGC": "DOWNERS GROVE COUGARS",
    "DIX": "DIXON WC",
    "EDW": "EDWARDSVILLE WC",
    "EJD": "ELMHUSRT JR. DUKES",
    "EPG": "EL PASO/GRIDLEY WC",
    "FCY": "FALCON YOUTH WC",
    "FEN": "FENWICK FALCONS WC",
    "FIS": "FISHER WC",
    "FLC": "FALCON WC",
    "FOX": "FOX VALLEY WC",
    "GEN": "GENESEO WC",
    "GER": "GLENBARD EAST JR. RAMS",
    "GLA": "GLADIATORS",
    "GLD": "GOLDEN EAGLES",
    "HBJ": "HIGHLAND BULLDOGS JR. WC",
    "HER": "HERRIN WC",
    "HJT": "HILLSBORO JR. TOPPERS",
    "HON": "HONONEGAH KIDS WC",
    "HPG": "HIGHLAND PARK LITTLE GIANTS",
    "HPN": "HOOPSTON AREA WC",
    "HRD": "HINSDALE RED DEVILS",
    "HRL": "HARLEM COUGARS",
    "HTW": "HARVEY PARK DISTRICT TWISTERS",
    "LAK": "LAKELAND PREDATORS",
    "LEM": "LEMONT BEARS WC",
    "LHI": "LIONHEART INTENSE WC",
    "LJP": "LOCKPORT JR PORTERS",
    "LLC": "LITTLE CELTICS",
    "LLF": "LITTLE FALCONS WC",
    "LLS": "LIL' STORM YOUTH WC",
    "LNW": "LINCOLN-WAY WC",
    "MDW": "MAD DOG WRESTLING ACADEMY",
    "MED": "MEDALIST WC",
    "MFV": "MARTINEZ FOX VALLEY ELITE",
    "MIY": "MARENGO INDIANS YOUTH WC",
    "MLI": "MINOOKA LITTLE INDIANS",
    "MNE": "MAINE EAGLES",
    "MOL": "MOLINE WC",
    "MRB": "MURPHYSBORO WC",
    "MRS": "MORRISON STALLIONS WC",
    "NDW": "NOTRE DAME WC",
    "NPV": "NAPERVILLE WC",
    "OFW": "OAK FOREST WARRIORS",
    "OKW": "OAKWOOD WC",
    "OLP": "O'FALLION LITTLE PANTHERS",
    "OLW": "OAK LAWN PARK DISTRICT WILDCATS",
    "OPP": "ORLAND PARK PIONEERS",
    "OSW": "OSWEGO PANTERS",
    "PAN": "PANTHER WC",
    "PEK": "PEKIN BOYS AND GIRLS CLUB",
    "PLF": "PLAINFIELD WC",
    "PLT": "PLAINFIELD TORNADOES WC",
    "PLW": "PANTHER CUB WC",
    "PNP": "PANTHER POWERHOUSE WC",
    "PON": "PONTIAC PYTHONS",
    "PRP": "PROVISO POWERHOUSE",
    "RJR": "RIVERDALE JR RAMS WC",
    "RMD": "RICHMOND WC",
    "ROX": "ROXANA KIDS WC",
    "RVB": "RIVERBEND WC",
    "SCN": "SCN YOUTH WC",
    "SHM": "SHAMROCK WC",
    "SJO": "SJO SPRATAN YOUTH",
    "SJR": "SHELBYVILLE JR. RAMS WC",
    "SKE": "SAUKEE YOUTH WC",
    "SKV": "SAUK VALLEY WC",
    "SOT": "SONS OF THUNDER",
    "SPR": "SPRINGFIELD CAPITAL KIDS WRESTLING",
    "STT": "ST. TARCISSUS",
    "TIG": "TIGER WC",
    "TLK": "TRIAD LITTLE KNIGHTS",
    "TPB": "TINLEY PARK BULLDOGS",
    "TRV": "TRI-VALLEY WC",
    "TTT": "TIGERTOWN TANGLERS",
    "TWW": "TEAM WEST WOLVES",
    "UNY": "UNITY WC",
    "VAN": "VANDALIA JR. WRESLTING",
    "VIT": "VITTUM CATS",
    "VLC": "VILLA LOMBARD COUGARS",
    "WHT": "WHEATON TIGERS",
    "WPK": "WOLFPAK WC",
    "WRF": "WRESTLING FACTORY",
    "WSV": "WESTVILLE YOUTH WC",
    "XTR": "XTREME WC",
    "YRK": "YORKVILLE WC",
}
# NOTE: Sometimes acronyms (or team names) differ between Novice and Senior
#       in the Team Scores.
NOVICE_TEAM_ACRONYM_MAPPING: dict[str, str] = {
    "ABC": "ALEDO BEAR COUNTRY",
    "ACE": "ACES WC",
    "AJP": "ALLEMAN JR. PIONEERS",
    "BJH": "BARTLETT JR. HAWKS",
    "BMH": "BISMARK-HENNING WC",
    "CHR": "CHARLESTON WC",
    "CJT": "CARY JR. TROJAN MATMEN",
    "CLD": "CHILLI DAWGS WC",
    "CLP": "CLIPPER WC",
    "CNT": "CENTRAL",
    "CRL": "CARLINVILLE KIDS WC",
    "EMS": "ERIE MIDDLE SCHOOL",
    "FRR": "FAIRMONT ROUGH RIDERS",
    "FTT": "FIGHTIN' TITANS",
    "GCW": "GC JR. WARRIORS",
    "JBC": "JOLIET BOYS CLUB COBRAS",
    "KGT": "KNIGHTS WC",
    "LNS": "LIONS WC",
    "MLB": "MACOMB LITTLE BOMBERS",
    "MLM": "MORTON LITTLE MUSTANGS",
    "MRT": "MORTON YOUTH WC",
    "MST": "MUSTANG WC",
    "MTP": "MT. PULASKI",
    "MTV": "MT. VERNON LIONS",
    "MTZ": "MT. ZION WC",
    "MWC": "MIDWEST CENTRAL YOUTH WC",
    "PRZ": "PEORIA RAZORBACKS",
    "RCL": "ROCHELLE",
    "RCT": "ROCHESTER WC",
    "RRT": "RICH RATTLERS WC",
    "SPD": "SPIDER WC",
    "SRD": "SHERRARD WC",
    "TAK": "TAKEDOWN WC",
    "TAY": "TAYLORVILLE WC",
    "TOM": "TOMCAT WC",
    "WHN": "WEST HANCOCK WC",
    "WJP": "WASHINGTON JR. PANTHERS",
    "WRC": "WARREN COUNTY WC",
    "YNG": "YOUNG CHAMPIONS",
}
SENIOR_TEAM_ACRONYM_MAPPING: dict[str, str] = {
    "ARG": "ARGENTA-OREANA KIDS CLUB",
    "BKT": "BLACK KATS WC",
    "BLV": "BELVIDERE BANDITS",
    "BTN": "BENTON JR. WC",
    "CLA": "CENTRAILIA",
    "CLD": "CHILLI DAWGS",
    "CMW": "CALUMET MEMORIAL PD WOLVERINES",
    "EFF": "EFFINGHAM JUNIOR WC",
    "ERV": "ERVIN WC",
    "GCW": "GRANITE CITY JR. WARRIORS",
    "GRM": "GERMANTOWN WC",
    "GRY": "GEORGETOWN RUDE DOGS YOUTH WC",
    "HOF": "HOFFMAN ESTATES WC",
    "HUR": "HURRICANES",
    "IMP": "IMPACT WC",
    "JCG": "JR. COUGARS",
    "JMS": "JR. MUSTANGS",
    "JVK": "JR. VIKINGS",
    "LAN": "LANCER WC",
    "LLB": "LITTLE BOILERS WC",
    "LLH": "LITTLE HUSKIES WC",
    "LPC": "L-P CRUNCHING CAVS",
    "LRB": "LITTLE REDBIRD WC",
    "LRS": "LITTLE REDSKIN WC",
    "MAT": "MATTOON YOUTH WC",
    "MEN": "MENDOTA WC",
    "PCC": "PRAIRIE CENTRAL-CHENOA HAWKS",
    "PLP": "PALATINE PANTHERS WC",
    "RAM": "RAMS WC",
    "RDW": "ROAD WARRIORS",
    "RKF": "ROCKFORD WC",
    "RKI": "ROCK ISLAND WC",
    "RKR": "ROCKRIDGE WC",
    "SAV": "SAVANNA REDHAWKS",
    "SCE": "ST. CHARLES EAST WC",
    "SIC": "SENECA IRISH CADETS",
    "STV": "STILLMAN VALLEY WC",
    "SYC": "SYCAMORE",
    "TVN": "TREVIAN",
    "UNT": "UNITED TOWNSHIP WC",
    "WBN": "WAUBONSIE WC",
    "WRB": "WARRENSBURG WC",
}
TEAM_NAME_MAPPING: dict[str, int] = {
    "A-J JUNIOR WILDCATS": 4,
    "ACES WC": 3,
    "ALEDO BEAR COUNTRY": 10002,
    "ALLEMAN JR. PIONEERS": 10003,
    "ANIMALS WC": 10004,
    "ARGENTA-OREANA KIDS CLUB": 8,
    "ARLINGTON CARDNALS": 9,
    "BADGERS WC": 14,
    "BARRINGTON BRONCOS": 15,
    "BARTLETT JR. HAWKS": 16,
    "BATAVIA PINNERS": 10005,
    "BELLEVILLE LITTLE DEVILS": 23,
    "BELVIDERE BANDITS": 24,
    "BENTON JR. WC": 26,
    "BETHALTO BULLS WC": 10006,
    "BISMARK-HENNING WC": 28,
    "BISON WC": 126,
    "BLACK KATS WC": 10007,
    "BLACKHAWK WC": 30,
    "BLOOMINGTON RAIDERS WC": 32,
    "BRAWLERS": 39,
    "CALUMET MEMORIAL PD WOLVERINES": 49,
    "CARBONDALE JUNIOR SPIRITS": 10009,
    "CARLINVILLE KIDS WC": 54,
    "CARY JR. TROJAN MATMEN": 59,
    "CENTRAILIA": 64,
    "CENTRAL": 10010,
    "CHAMPAIGN KIDS WC": 65,
    "CHARLESTON WC": 69,
    "CHILLI DAWGS WC": 10014,
    "CHILLI DAWGS": 10014,
    "CLIPPER WC": 80,
    "COLLINSVILLE RAIDERS": 338,
    "CROSSTOWN CRUSHERS": 10019,
    "CRYSTAL LAKE WIZARDS": 89,
    "CUMBERLAND YOUTH WC": 90,
    "DAKOTA WC": 92,
    "DIXON WC": 98,
    "DOWNERS GROVE COUGARS": 100,
    "DUNDEE HIGHLANDERS": 102,
    "EDWARDSVILLE WC": 110,
    "EFFINGHAM JUNIOR WC": 10021,
    "EL PASO/GRIDLEY WC": 112,
    "ELMHUSRT JR. DUKES": 10024,
    "ERIE MIDDLE SCHOOL": 10025,
    "ERVIN WC": 10026,
    "FAIRMONT ROUGH RIDERS": 10027,
    "FALCON WC": 124,
    "FALCON YOUTH WC": 123,
    "FENWICK FALCONS WC": 10028,
    "FIGHTIN' TITANS": 128,
    "FISHER WC": 130,
    "FOX VALLEY WC": 134,
    "GC JR. WARRIORS": 10040,
    "GENESEO WC": 10033,
    "GEORGETOWN RUDE DOGS YOUTH WC": 10035,
    "GERMANTOWN WC": 10037,
    "GLADIATORS": 10038,
    "GLENBARD EAST JR. RAMS": 147,
    "GOLDEN EAGLES": 149,
    "GRANITE CITY JR. WARRIORS": 10040,
    "HARLEM COUGARS": 10041,
    "HARVARD WC": 161,
    "HARVEY PARK DISTRICT TWISTERS": 162,
    "HERRIN WC": 10042,
    "HIGHLAND BULLDOGS JR. WC": 168,
    "HIGHLAND PARK LITTLE GIANTS": 169,
    "HILLSBORO JR. TOPPERS": 170,
    "HINSDALE RED DEVILS": 171,
    "HOFFMAN ESTATES WC": 172,
    "HONONEGAH KIDS WC": 173,
    "HOOPSTON AREA WC": 174,
    "HURRICANES": 10045,
    "IMPACT WC": 654,
    "JOLIET BOYS CLUB COBRAS": 10047,
    "JR. COUGARS": 196,
    "JR. MUSTANGS": 10051,
    "JR. VIKINGS": 10055,
    "KNIGHTS WC": 206,
    "L-P CRUNCHING CAVS": 241,
    "LAKELAND PREDATORS": 10057,
    "LANCER WC": 216,
    "LAWRENCE COUNTY WC": 217,
    "LEMONT BEARS WC": 219,
    "LIL' STORM YOUTH WC": 10060,
    "LINCOLN-WAY WC": 227,
    "LIONHEART INTENSE WC": 228,
    "LIONS WC": 229,
    "LITTLE BOILERS WC": 232,
    "LITTLE CELTICS": 233,
    "LITTLE FALCONS WC": 10062,
    "LITTLE HUSKIES WC": 235,
    "LITTLE REDBIRD WC": 10065,
    "LITTLE REDSKIN WC": 10066,
    "LOCKPORT JR PORTERS": 202,
    "MACOMB LITTLE BOMBERS": 243,
    "MAD DOG WRESTLING ACADEMY": 244,
    "MAINE EAGLES": 245,
    "MARENGO INDIANS YOUTH WC": 248,
    "MARTINEZ FOX VALLEY ELITE": 250,
    "MATTOON YOUTH WC": 252,
    "MEDALIST WC": 10071,
    "MENDOTA WC": 261,
    "METAMORA KIDS WC": 262,
    "MIDWEST CENTRAL YOUTH WC": 263,
    "MINOOKA LITTLE INDIANS": 266,
    "MOLINE WC": 268,
    "MORRISON STALLIONS WC": 270,
    "MORTON LITTLE MUSTANGS": 271,
    "MORTON YOUTH WC": 272,
    "MT. PULASKI": 10073,
    "MT. VERNON LIONS": 275,
    "MT. ZION WC": 276,
    "MURPHYSBORO WC": 278,
    "MUSTANG WC": 279,
    "NAPERVILLE WC": 281,
    "NOTRE DAME WC": 295,
    "O'FALLION LITTLE PANTHERS": 296,
    "OAK FOREST WARRIORS": 297,
    "OAK LAWN PARK DISTRICT WILDCATS": 10075,
    "OAKWOOD WC": 299,
    "ORLAND PARK PIONEERS": 306,
    "OSWEGO PANTERS": 10076,
    "PALATINE PANTHERS WC": 10078,
    "PANTHER CUB WC": 10079,
    "PANTHER POWERHOUSE WC": 313,
    "PANTHER WC": 346,
    "PEKIN BOY AND GIRLS CLUB": 319,
    "PEKIN BOYS AND GIRLS CLUB": 319,
    "PEORIA RAZORBACKS": 321,
    "PLAINFIELD TORNADOES WC": 10081,
    "PLAINFIELD WC": 326,
    "PONTIAC PYTHONS": 10082,
    "PRAIRIE CENTRAL-CHENOA HAWKS": 10083,
    "PROVISO POWERHOUSE": 314,
    "RAMS WC": 236,
    "RICH RATTLERS WC": 349,
    "RICHMOND WC": 350,
    "RIVERBEND WC": 354,
    "RIVERDALE JR RAMS WC": 536,
    "ROAD WARRIORS": 357,
    "ROCHELLE": 358,
    "ROCHESTER WC": 10087,
    "ROCK ISLAND WC": 361,
    "ROCKFORD WC": 364,
    "ROCKRIDGE WC": 10088,
    "ROXANA KIDS WC": 371,
    "SAUK VALLEY WC": 375,
    "SAUKEE YOUTH WC": 376,
    "SAVANNA REDHAWKS": 10089,
    "SCN YOUTH WC": 377,
    "SENECA IRISH CADETS": 379,
    "SHAMROCK WC": 380,
    "SHELBYVILLE JR. RAMS WC": 382,
    "SHERRARD WC": 383,
    "SJO SPRATAN YOUTH": 402,
    "SONS OF THUNDER": 10091,
    "SPIDER WC": 10094,
    "SPRINGFIELD CAPITAL KIDS WRESTLING": 397,
    "ST. CHARLES EAST WC": 10096,
    "ST. TARCISSUS": 403,
    "STILLMAN VALLEY WC": 407,
    "SYCAMORE": 418,
    "TAKEDOWN WC": 10100,
    "TAYLORVILLE WC": 420,
    "TEAM WEST WOLVES": 10101,
    "TIGER WC": 10103,
    "TIGERTOWN TANGLERS": 441,
    "TINLEY PARK BULLDOGS": 443,
    "TOMCAT WC": 448,
    "TREVIAN": 288,
    "TRI-VALLEY WC": 10105,
    "TRIAD LITTLE KNIGHTS": 452,
    "UNITED TOWNSHIP WC": 10107,
    "UNITY WC": 457,
    "VANDALIA JR. WRESLTING": 461,
    "VILLA LOMBARD COUGARS": 10109,
    "VITTUM CATS": 466,
    "WARREN COUNTY WC": 467,
    "WARRENSBURG WC": 468,
    "WASHINGTON JR. PANTHERS": 10110,
    "WAUBONSIE WC": 473,
    "WEST HANCOCK WC": 479,
    "WESTVILLE YOUTH WC": 482,
    "WHEATON TIGERS": 483,
    "WOLFPAK WC": 490,
    "WRESTLING FACTORY": 10115,
    "XTREME WC": 496,
    "YORKVILLE WC": 497,
    "YOUNG CHAMPIONS": 10116,
    "ZEE-BEE STINGERS": 501,
}
NOVICE_EXTRA_TEAM_SCORES: dict[str, float] = {
    "CALUMET MEMORIAL PD WOLVERINES": 0.0,
    "HARVARD WC": 0.0,
    "HURRICANES": 0.0,
}
SENIOR_EXTRA_TEAM_SCORES: dict[str, float] = {
    "HARVARD WC": 0.0,
    "LAWRENCE COUNTY WC": 0.0,
    "METAMORA KIDS WC": 0.0,
    "PEKIN BOY AND GIRLS CLUB": 0.0,
    "ZEE-BEE STINGERS": 0.0,
    ########################################
    "MORTON LITTLE MUSTANGS": -1.0,
}


def main():
    with open(HERE / "extracted.2005.json") as file_obj:
        extracted = bracket_utils.ExtractedTournament.model_validate_json(
            file_obj.read()
        )

    weight_classes = extracted.weight_classes
    bracket_utils.validate_acronym_mapping_names(
        weight_classes,
        (
            TEAM_ACRONYM_MAPPING,
            NOVICE_TEAM_ACRONYM_MAPPING,
            SENIOR_TEAM_ACRONYM_MAPPING,
        ),
        (NOVICE_EXTRA_TEAM_SCORES, SENIOR_EXTRA_TEAM_SCORES),
        TEAM_NAME_MAPPING,
    )
    unclassified = sorted(
        name for name, team_id in TEAM_NAME_MAPPING.items() if team_id < 0
    )
    if unclassified:
        raise ValueError("Some teams are unclassified", unclassified)

    bracket_utils.validate_acronym_mappings_divisons(
        weight_classes,
        TEAM_ACRONYM_MAPPING,
        NOVICE_TEAM_ACRONYM_MAPPING,
        SENIOR_TEAM_ACRONYM_MAPPING,
    )

    # NOTE: We just do team score **matching** for validation (but do not use
    #       the outputs).
    bracket_utils.team_scores_for_sql(
        "novice",
        TOURNAMENT_ID,
        extracted,
        TEAM_ACRONYM_MAPPING,
        NOVICE_TEAM_ACRONYM_MAPPING,
        TEAM_NAME_MAPPING,
        NOVICE_EXTRA_TEAM_SCORES,
    )
    bracket_utils.team_scores_for_sql(
        "senior",
        TOURNAMENT_ID,
        extracted,
        TEAM_ACRONYM_MAPPING,
        SENIOR_TEAM_ACRONYM_MAPPING,
        TEAM_NAME_MAPPING,
        SENIOR_EXTRA_TEAM_SCORES,
    )

    start_id = 4261
    mapped_competitors = bracket_utils.get_competitors_for_sql(
        start_id,
        weight_classes,
        TEAM_ACRONYM_MAPPING,
        NOVICE_TEAM_ACRONYM_MAPPING,
        SENIOR_TEAM_ACRONYM_MAPPING,
        TEAM_NAME_MAPPING,
    )
    bracket_utils.print_competitors_sql(mapped_competitors.competitor_rows)


if __name__ == "__main__":
    main()
